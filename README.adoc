= A GitHub Action to check your code with https://github.com/saveourtool/diktat[_diKTat_]
:toc:
:imagesdir: docs/images

image::https://img.shields.io/badge/License-MIT-yellow.svg[License: MIT,link="https://opensource.org/licenses/MIT"]

== Features

 * Customizable `diktat-analysis.yml` location. You can use the rule set
   configuration with an alternate name or at a non-default location.
 * Customizable JVM vendor and version. You can run diKTat using a default JVM,
   or you can set up your own.
 * Customizable reporters (_SARIF_, _JSON_, _Checkstyle_ XML).
 * Allows multiple input paths. If you have a multi-module project and only wish
   to check certain directories or modules, you can configure the action
   accordingly.
 * The last line of the log output reported to the summary page:
   image:diktat-check-summary.png[diKTat Check summary]

== Usage

In the simplest scenario, the action can be used without input parameters; you
just need to check out your code first, using
https://github.com/marketplace/actions/checkout[`actions/checkout`]:

[source,yaml]
----
jobs:
  diktat_check:
    name: 'diKTat Check'
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - uses: saveourtool/benedikt@v1
----

== Configuration

== Outputs

The action returns the exit code of the command-line client using the
`exit-code` output parameter, e. g.:

[source,yaml]
----
jobs:
  diktat_check:
    name: 'diKTat Check'
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - id: diktat
        uses: saveourtool/benedikt@v1

      - name: 'Read the exit code of diKTat'
        if: ${{ always() }}
        run: echo "diKTat exited with code ${{ steps.diktat.outputs.exit-code }}"
        shell: bash
----

The exit codes are documented below.

=== Exit codes

.Exit codes
[cols="1,3,1"]
|===
| Exit code | Meaning | Treated as a failure

| 0
| _diKTat_ found no errors in your code
| **No**

| 1
| _diKTat_ reported some warnings in your code
| Depends on the `fail-on-error` input parameter, the default is **Yes**

| 2
| The JVM was not found (probably, you need to set up the JVM explicitly, using
the `java-distribution` and `java-version` input parameters)
| **Yes**

| 3
| Failure while downloading dependencies
| **Yes**

| 4
| Unsupported command-line switch
| **Yes**

| 5
| _diKTat_ JAR was not found
| **Yes**

| 6
| A command-line switch requires an argument
| **Yes**

| 7
| No source files to check were found
| **Yes**
|===
